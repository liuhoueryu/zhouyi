{% extends "zhouyi_app/base.html" %}

{% block title %}占卜历史 - 周易占卜系统{% endblock %}

{% block content %}
<div>
    <h2 style="text-align: center;">占卜历史记录</h2>
    
    <div style="text-align: center; margin-bottom: 20px;">
        <a href="/index/" class="btn">返回首页</a>
    </div>
    
    {% if page_obj %}
        <p style="text-align: center; color: #666; margin-bottom: 20px;">
            共 {{ page_obj.paginator.count }} 条记录
        </p>
        
        <ul class="history-list">
            {% for record in page_obj %}
            <li class="history-item">
                <a href="/detail/{{ record.id }}/">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="text-align: left;">
                            <strong style="font-size: 1.1em;">{{ record.thing }}</strong>
                            <div style="color: #666; margin-top: 5px;">
                                {{ record.hexagram_name }} ({{ record.hexagram_numbers }}) 
                                {% if record.changing_lines %}
                                <span style="color: #e74c3c;">• 有变爻</span>
                                {% endif %}
                            </div>
                        </div>
                        <div style="text-align: right; color: #999; font-size: 0.9em;">
                            {{ record.created_time|date:"Y-m-d H:i" }}
                        </div>
                    </div>
                </a>
            </li>
            {% endfor %}
        </ul>
        
        <div class="pagination">
            <span class="step-links">
                {% if page_obj.has_previous %}
                    <a href="?page=1">&laquo; 首页</a>
                    <a href="?page={{ page_obj.previous_page_number }}">上一页</a>
                {% endif %}

                <span class="current">
                    第 {{ page_obj.number }} 页，共 {{ page_obj.paginator.num_pages }} 页
                </span>

                {% if page_obj.has_next %}
                    <a href="?page={{ page_obj.next_page_number }}">下一页</a>
                    <a href="?page={{ page_obj.paginator.num_pages }}">末页 &raquo;</a>
                {% endif %}
            </span>
        </div>
    {% else %}
        <div style="text-align: center; padding: 40px;">
            <p style="font-size: 1.2em; color: #666;">暂无占卜记录</p>
            <a href="/index/" class="btn" style="margin-top: 20px;">开始第一次占卜</a>
        </div>
    {% endif %}
</div>
{% endblock %}