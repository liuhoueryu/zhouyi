{% extends "zhouyi_app/base.html" %}

{% block title %}AIæ´å¯Ÿ - å‘¨æ˜“å åœç³»ç»Ÿ{% endblock %}

{% block content %}
<div style="text-align: center;">
    <h2>ğŸ¤– AIæ·±åº¦æ´å¯Ÿ</h2>
    
    {% if not ai_enabled %}
    <div class="warning-box">
        <h4>âš ï¸ AIåŠŸèƒ½æœªå®Œå…¨å¯ç”¨</h4>
        <p>éƒ¨åˆ†æ·±åº¦å­¦ä¹ æ¨¡å‹åŠ è½½å¤±è´¥ï¼ŒAIåŠŸèƒ½å¯èƒ½å—é™ã€‚è¯·æ£€æŸ¥æ¨¡å‹ä¾èµ–å®‰è£…ã€‚</p>
    </div>
    {% endif %}
    
    <div class="info-box">
        <h3>æ•°æ®æ¦‚è§ˆ</h3>
        <p>æ€»å åœè®°å½•: <strong>{{ total_records }}</strong> æ¡</p>
        <p>AIåˆ†æè®°å½•: <strong>{{ recent_ai_analyzed|length }}</strong> æ¡</p>
    </div>
    
    <!-- æƒ…æ„Ÿåˆ†å¸ƒ -->
    {% if sentiment_data %}
    <div style="margin: 30px 0;">
        <h3>æƒ…æ„Ÿåˆ†å¸ƒåˆ†æ</h3>
        <div style="display: flex; justify-content: center; flex-wrap: wrap;">
            {% for sentiment, count in sentiment_data.items %}
            <div style="margin: 10px; text-align: center;">
                <div class="sentiment-badge sentiment-{{ sentiment }}">
                    {{ sentiment }}
                </div>
                <div style="font-size: 24px; font-weight: bold;">{{ count }}</div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    <!-- æœ€è¿‘AIåˆ†æè®°å½• -->
    {% if recent_ai_analyzed %}
    <div style="margin: 30px 0;">
        <h3>æœ€è¿‘AIåˆ†æè®°å½•</h3>
        <div style="text-align: left; max-width: 600px; margin: 0 auto;">
            {% for record in recent_ai_analyzed %}
            <div class="similar-case">
                <a href="/detail/{{ record.id }}/">
                    <strong>{{ record.thing }}</strong><br>
                    <span class="sentiment-badge sentiment-{{ record.sentiment_analysis.sentiment|default:'neutral' }}" style="font-size: 12px;">
                        {{ record.sentiment_analysis.sentiment|default:"ä¸­æ€§" }}
                    </span>
                    <small>Â· {{ record.hexagram_name }} Â· {{ record.created_time|date:"m-d H:i" }}</small>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    <div style="margin: 30px 0;">
        <a href="/index/" class="btn">è¿”å›é¦–é¡µ</a>
        <a href="/history/" class="btn btn-secondary">æŸ¥çœ‹å…¨éƒ¨å†å²</a>
    </div>
    
    <div style="margin-top: 40px; color: #666; font-size: 14px;">
        <p>ğŸ’¡ AIæ´å¯ŸåŸºäºæ·±åº¦å­¦ä¹ ç®—æ³•åˆ†æå†å²å åœæ•°æ®ï¼Œæä¾›æ•°æ®é©±åŠ¨çš„æ™ºæ…§å»ºè®®</p>
    </div>
</div>
{% endblock %}